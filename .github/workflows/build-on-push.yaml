name: Build Soggy on push
on:
  push:
    paths:
      - soggy
      - .github/workflows/build-on-push.yaml
    branches-ignore:
      - dependabot/**

jobs:
  build:
    runs-on: windows-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3
        with:
          submodules: true
          persist-credentials: false
          
      - name: install dependencies (vcpkg)
        run: vcpkg install protobuf lua[cpp]:x64-windows
        
      - name: Move Soggy src
        shell: bash
        run: mvÂ soggy/* .
        
      - name: Build
        run: |
          cmake -B build -G "Unix Makefiles"
          cmake --build build -j8
